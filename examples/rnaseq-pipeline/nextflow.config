/*
 * Configuration for RNA-seq Pipeline Example
 * Demonstrates nf-pregex plugin setup
 */

// Enable nf-pregex plugin
plugins {
    id 'nf-pregex@0.1.0'
}

// Manifest
manifest {
    name = 'nf-pregex-rnaseq-example'
    author = 'nf-pregex contributors'
    description = 'Simple RNA-seq pipeline demonstrating nf-pregex pattern matching benefits'
    mainScript = 'main.nf'
    version = '1.0.0'
    nextflowVersion = '>=23.10.0'
}

// Default parameters
params {
    // Input files
    reads = "data/*_{1,2}.fastq.gz"
    transcriptome = null
    
    // Output directory
    outdir = "results"
    
    // Help message
    help = false
}

// Process configuration
process {
    // Default resources
    cpus = 2
    memory = '4.GB'
    time = '1.h'
    
    // Process-specific settings
    withName: 'FASTQC' {
        cpus = 2
        memory = '2.GB'
    }
    
    withName: 'SALMON_INDEX' {
        cpus = 4
        memory = '8.GB'
    }
    
    withName: 'SALMON_QUANT' {
        cpus = 4
        memory = '8.GB'
    }
    
    withName: 'MULTIQC' {
        cpus = 1
        memory = '2.GB'
    }
}

// Wave and Fusion configuration
wave {
    enabled = true
}

fusion {
    enabled = true
}

// Executor configuration
executor {
    name = 'local'
    cpus = 8
    memory = '16.GB'
}

// Reporting
report {
    enabled = true
    file = "${params.outdir}/pipeline_report.html"
    overwrite = true
}

timeline {
    enabled = true
    file = "${params.outdir}/timeline.html"
    overwrite = true
}

trace {
    enabled = true
    file = "${params.outdir}/trace.txt"
    overwrite = true
}

// Profiles
profiles {
    standard {
        process.executor = 'local'
    }
    
    docker {
        docker.enabled = true
    }
    
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
    }
    
    test {
        params {
            reads = "${projectDir}/test_data/*_{1,2}.fastq.gz"
            transcriptome = "${projectDir}/test_data/transcriptome.fa"
            outdir = "test_results"
        }
    }
}
